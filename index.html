<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprende Python Interactivo</title>
    <!-- Carga de Tailwind CSS para un diseño moderno y responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carga de la fuente Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para la tipografía y el editor */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc;
        }
        .code-editor {
            font-family: monospace;
            background-color: #1e1e1e; /* Fondo oscuro tipo IDE */
            color: #d4d4d4; /* Color de texto claro */
            padding: 1rem;
            border-radius: 0.5rem;
            resize: none;
            min-height: 200px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
        }
        /* Resaltar el tema actual en el sidebar */
        .nav-item.active {
            background-color: #4f46e5;
            color: white;
            font-weight: 600;
        }
        /* Estilo para el texto de código en las explicaciones */
        code {
            background-color: #e0e7ff;
            color: #4f46e5;
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: 600;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Encabezado (Header) -->
    <header class="bg-white shadow-md p-4 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-bold text-indigo-600">Aprende Python Interactivo</h1>
            <span class="text-sm text-gray-500 hidden sm:block">Conceptos Esenciales para Principiantes</span>
        </div>
    </header>

    <!-- Contenedor Principal (Sidebar y Contenido) -->
    <div class="flex flex-1 max-w-7xl mx-auto w-full">

        <!-- Navegación (Sidebar) - Visible en escritorio, colapsable en móvil -->
        <nav id="sidebar" class="w-64 bg-white p-4 border-r border-gray-200 hidden md:block">
            <h2 class="text-lg font-semibold mb-4 text-gray-700">Unidades</h2>
            <ul id="unit-list">
                <!-- Los ítems de las unidades se inyectarán aquí por JavaScript -->
            </ul>
        </nav>

        <!-- Área de Contenido Principal -->
        <main class="flex-1 p-6 md:p-8">
            <div id="content-area" class="bg-white p-6 rounded-lg shadow-xl">
                <!-- Título del Tema -->
                <h2 id="topic-title" class="text-3xl font-bold text-gray-800 mb-4 border-b pb-2"></h2>

                <!-- Explicación Teórica -->
                <section id="theory-section" class="mb-8 text-gray-600 leading-relaxed"></section>

                <!-- Escenario Dinámico (Problema y Editor) -->
                <section id="scenario-section" class="bg-indigo-50 p-6 rounded-lg border-l-4 border-indigo-500">
                    <h3 class="text-2xl font-semibold text-indigo-700 mb-4">Escenario de Práctica</h3>
                    <p id="task-description" class="mb-4 text-gray-700"></p>

                    <!-- Editor de Código -->
                    <textarea id="code-editor" class="code-editor w-full border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500" placeholder="# Escribe tu código Python aquí..."></textarea>

                    <!-- Botón de Ejecutar -->
                    <button id="run-button" onclick="runCode()" class="mt-4 px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition duration-150 shadow-md">
                        Ejecutar / Verificar
                    </button>
                </section>

                <!-- Área de Resultados y Retroalimentación -->
                <div id="results-area" class="mt-6 p-4 rounded-lg hidden" role="alert">
                    <p id="feedback-message" class="font-medium"></p>
                    <button id="next-button" onclick="loadNextScenario()" class="hidden mt-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">
                        Siguiente Unidad &rarr;
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Pie de Página (Footer) -->
    <footer class="bg-gray-800 text-white p-4 mt-auto">
        <div class="max-w-7xl mx-auto text-center text-sm">
            &copy; 2024 Aprende Python Interactivo. Proyecto Educativo.
        </div>
    </footer>

    <script>
        // Lógica JavaScript para los escenarios dinámicos
        
        let currentScenarioIndex = 0;

        // Definición de los escenarios de aprendizaje
        const SCENARIOS = [
            {
                id: 0,
                title: "Introducción a Python",
                explanation: `Python es uno de los lenguajes de programación más populares del mundo. Es conocido por su sintaxis clara y legible, lo que lo hace perfecto para principiantes.

                <p class="mt-3">Se utiliza en campos como desarrollo web, ciencia de datos, inteligencia artificial y automatización.</p>`,
                task: "No hay ejercicio en esta unidad. Presiona 'Siguiente Unidad' para comenzar.",
                validation: (code) => {
                    return { success: true, feedback: "¡Bienvenido! Es hora de empezar a programar." };
                }
            },
            {
                id: 1,
                title: "Variables y Asignación",
                explanation: `Una variable es un nombre que se refiere a un valor en la memoria de la computadora. Es como una etiqueta que le pones a una caja para saber qué contiene.

                <p class="mt-3">Para asignar un valor, usamos el signo igual: <code>nombre_variable = valor</code>.</p>`,
                task: "Crea una variable llamada **'puntuacion'** y asígnale el valor entero **95**.",
                validation: (code) => {
                    // Limpia el código para una validación simple (remueve espacios y minúsculas)
                    const normalizedCode = code.replace(/\s/g, '').toLowerCase();

                    // Regex para verificar si existe 'puntuacion=95'
                    const regex = /puntuacion=95(?!.)/;

                    if (!regex.test(normalizedCode)) {
                        return { success: false, feedback: "Asegúrate de que la variable se llame exactamente 'puntuacion' y el valor sea el número '95'. Revisa la ortografía." };
                    }
                    return { success: true, feedback: "¡Excelente! La variable 'puntuacion' ha sido declarada y asignada correctamente." };
                }
            },
            {
                id: 2,
                title: "Tipos de Datos: String e Impresión",
                explanation: `Una 'string' (cadena de texto) es una secuencia de caracteres, y siempre se encierra entre comillas (simples o dobles).

                <p class="mt-3">La función <code>print()</code> se usa para mostrar texto o el valor de una variable en la consola. Puedes concatenar (unir) strings con el operador <code>+</code>.</p>`,
                task: "Declara una variable **'saludo'** con el valor 'Hola ' (con un espacio final) y otra **'nombre'** con tu nombre. Luego, imprime la concatenación de ambas variables.",
                validation: (code) => {
                    // Para simular la ejecución de Python, validaremos 3 partes:
                    // 1. Declaración de saludo
                    // 2. Declaración de nombre
                    // 3. Uso de print() con la concatenación

                    if (!/saludo\s*=\s*['"]Hola\s+['"]/.test(code) && !/saludo\s*=\s*['"]Hola\s*['"]/.test(code)) {
                        return { success: false, feedback: "Falta o es incorrecta la variable 'saludo'. Debe contener 'Hola ' (con o sin comillas simples/dobles)." };
                    }

                    if (!/nombre\s*=\s*['"].+['"]/.test(code)) {
                         return { success: false, feedback: "Falta o es incorrecta la variable 'nombre'. Asegúrate de que tenga un valor de string (ej. 'Mundo')." };
                    }

                    if (!/print\s*\(\s*saludo\s*\+\s*nombre\s*\)/.test(code)) {
                        return { success: false, feedback: "Asegúrate de usar la función 'print(saludo + nombre)' para concatenar e imprimir las variables." };
                    }

                    return { success: true, feedback: "¡Correcto! Has usado variables de tipo string y la función 'print' para concatenarlas." };
                }
            },
            {
                id: 3,
                title: "Estructuras de Control: Condicionales (if/else)",
                explanation: `Las estructuras condicionales (<code>if</code>, <code>elif</code>, <code>else</code>) permiten que el programa tome decisiones. El bloque de código bajo un 'if' solo se ejecuta si la condición es verdadera (True).

                <p class="mt-3">¡Recuerda la indentación y los dos puntos (:)!</p>`,
                task: "Dado que ya existe la variable `numero = 15`. Escribe una estructura `if` que imprima **'El número es grande'** si `numero` es mayor que 10, y un `else` que imprima **'El número es pequeño'** en caso contrario.",
                validation: (code) => {
                    // Simulación del entorno: inyectar la variable inicial
                    const fullCode = "numero = 15\n" + code;
                    const result = { success: false, feedback: "" };

                    // 1. Verificar la estructura del if/else
                    if (!/if\s+numero\s*>\s*10\s*:\s*print\s*\(['"]El número es grande['"]\)/s.test(code)) {
                        result.feedback = "El bloque 'if' es incorrecto o no imprime el mensaje exacto: 'El número es grande'.";
                        return result;
                    }

                    if (!/else\s*:\s*print\s*\(['"]El número es pequeño['"]\)/s.test(code)) {
                        result.feedback = "El bloque 'else' es incorrecto o no imprime el mensaje exacto: 'El número es pequeño'.";
                        return result;
                    }

                    // 2. Simulación de la lógica (ejecutar 'numero = 15')
                    // Dado que 15 > 10 es True, el resultado esperado es 'El número es grande'.
                    // Aquí, simplemente validamos la estructura, ya que la simulación real de la ejecución es compleja.
                    
                    return { success: true, feedback: "¡Fantástico! Has implementado el condicional 'if/else' correctamente. El programa habría impreso 'El número es grande'." };
                }
            }
        ];

        // Función para cargar el escenario actual
        function loadScenario(index) {
            currentScenarioIndex = index;
            const scenario = SCENARIOS[index];

            // 1. Actualizar Navegación
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.getElementById(`nav-item-${index}`).classList.add('active');

            // 2. Actualizar Contenido
            document.getElementById('topic-title').textContent = scenario.title;
            document.getElementById('theory-section').innerHTML = scenario.explanation;
            
            // 3. Actualizar Escenario de Práctica
            const taskEl = document.getElementById('task-description');
            const editorEl = document.getElementById('code-editor');
            const runButton = document.getElementById('run-button');

            if (scenario.task) {
                taskEl.innerHTML = scenario.task;
                editorEl.value = scenario.id === 3 ? "numero = 15\n# Escribe tu código aquí...\n" : "";
                editorEl.classList.remove('hidden');
                runButton.classList.remove('hidden');
            } else {
                // Escenario sin tarea (como la introducción)
                taskEl.textContent = scenario.task || "No hay ejercicio en esta unidad.";
                editorEl.value = "";
                editorEl.classList.add('hidden');
                runButton.classList.add('hidden');
            }
            
            // 4. Limpiar Resultados
            const resultsArea = document.getElementById('results-area');
            const nextButton = document.getElementById('next-button');

            resultsArea.classList.add('hidden');
            nextButton.classList.add('hidden');
        }

        // Función para manejar el botón de Ejecutar/Verificar
        function runCode() {
            const code = document.getElementById('code-editor').value;
            const scenario = SCENARIOS[currentScenarioIndex];
            const resultsArea = document.getElementById('results-area');
            const feedbackMessage = document.getElementById('feedback-message');
            const nextButton = document.getElementById('next-button');

            // Validar el código usando la función específica del escenario
            const validationResult = scenario.validation(code);

            resultsArea.classList.remove('hidden');
            feedbackMessage.textContent = validationResult.feedback;
            nextButton.classList.add('hidden'); // Ocultar por defecto

            if (validationResult.success) {
                // Éxito
                resultsArea.classList.remove('bg-red-100', 'border-red-500', 'text-red-700');
                resultsArea.classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                nextButton.classList.remove('hidden');
            } else {
                // Error
                resultsArea.classList.remove('bg-green-100', 'border-green-500', 'text-green-700');
                resultsArea.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
            }
        }

        // Función para avanzar al siguiente escenario
        function loadNextScenario() {
            const nextIndex = currentScenarioIndex + 1;
            if (nextIndex < SCENARIOS.length) {
                loadScenario(nextIndex);
            } else {
                // Fin de los escenarios
                alert("¡Felicidades! Has completado todos los escenarios iniciales.");
                loadScenario(0); // Volver al inicio
            }
        }

        // Función de inicialización
        function initApp() {
            const unitList = document.getElementById('unit-list');

            // Crear los ítems de navegación
            SCENARIOS.forEach((scenario, index) => {
                const li = document.createElement('li');
                li.className = "mb-2";
                const a = document.createElement('a');
                a.id = `nav-item-${index}`;
                a.href = "#";
                a.textContent = `${index}. ${scenario.title}`;
                a.className = "nav-item block p-2 rounded-lg text-gray-700 hover:bg-indigo-100 transition duration-150 cursor-pointer";
                a.onclick = (e) => {
                    e.preventDefault();
                    loadScenario(index);
                };
                li.appendChild(a);
                unitList.appendChild(li);
            });

            // Cargar el primer escenario al inicio
            loadScenario(0);
        }

        // Iniciar la aplicación al cargar la página
        window.onload = initApp;

    </script>
</body>
</html>